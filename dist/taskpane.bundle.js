!function(){function e(e){return function(e){if(Array.isArray(e))return t(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,n){if(e){if("string"==typeof e)return t(e,n);var a={}.toString.call(e).slice(8,-1);return"Object"===a&&e.constructor&&(a=e.constructor.name),"Map"===a||"Set"===a?Array.from(e):"Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a)?t(e,n):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function t(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=Array(t);n<t;n++)a[n]=e[n];return a}!function(){"use strict";var t=null,n=null;function a(){var a=document.getElementById("client-select").value;if(a){var l=[];t.to.getAsync((function(c){if(c.status!==Office.AsyncResultStatus.Failed){var r=c.value.map((function(e){return e.emailAddress}));l.push.apply(l,e(r)),t.cc.getAsync((function(c){if(c.status!==Office.AsyncResultStatus.Failed){var r=c.value.map((function(e){return e.emailAddress}));l.push.apply(l,e(r)),t.bcc.getAsync((function(t){if(t.status!==Office.AsyncResultStatus.Failed){var c=t.value.map((function(e){return e.emailAddress}));l.push.apply(l,e(c)),function(e,t){var a={internal:[],valid:[],invalid:[]};e.forEach((function(e){var t,i=null===(t=e.split("@")[1])||void 0===t?void 0:t.toLowerCase();i&&(i===n?a.internal.push(e):function(e){return["gmail.com","yahoo.com","outlook.com","hotmail.com","aol.com"].includes(e)||e.includes(".")}(i)?a.valid.push(e):a.invalid.push(e))}));var l=document.getElementById("validation-results");if(l.innerHTML="",a.invalid.length>0){i("Found ".concat(a.invalid.length," potentially incorrect email(s)"),"warning");var c=document.createElement("div");c.className="validation-warning";var r=document.createElement("div");r.className="recipients-list",a.internal.forEach((function(e){var t=document.createElement("span");t.className="email-internal",t.textContent=e,r.appendChild(t)})),a.valid.forEach((function(e){var t=document.createElement("span");t.className="email-valid",t.textContent=e,r.appendChild(t)})),a.invalid.forEach((function(e){var t=document.createElement("span");t.className="email-invalid",t.textContent=e,r.appendChild(t)}));var s=document.createElement("div");s.className="button-container";var d=document.createElement("button");d.className="ms-Button ms-Button--default",d.innerHTML="Go Back",d.onclick=function(){o("went_back",t,a.invalid),l.innerHTML="",i("","none")};var u=document.createElement("button");u.className="ms-Button ms-Button--primary",u.innerHTML="Proceed Anyway",u.onclick=function(){confirm("Warning: The following email(s) appear to be incorrect:\n\n".concat(a.invalid.join("\n"),"\n\nDo you want to proceed anyway?"))&&(o("proceeded",t,a.invalid),l.innerHTML="",i("Proceeding with send","info"))},c.appendChild(r),s.appendChild(d),s.appendChild(u),c.appendChild(s),l.appendChild(c)}else i("All recipients verified","success")}(l,a)}else i("Failed to get BCC recipients","error")}))}else i("Failed to get CC recipients","error")}))}else i("Failed to get recipients","error")}))}else i("Select a client organization","warning")}function i(e,t){var n=document.getElementById("validation-status");n.textContent=e,n.className="status-text status-"+t}function o(e,n,a){var i={timestamp:(new Date).toISOString(),user:Office.context.mailbox.userProfile.emailAddress,action:e,clientDomain:n,invalidRecipients:a,subject:t.subject.slice(0,100)};console.log("MailVolt Log:",i)}Office.onReady((function(){if(Office.context.mailbox){document.getElementById("app-body").style.display="block",document.getElementById("sideload-msg").style.display="none";var e=Office.context.mailbox.userProfile.emailAddress;n=e.split("@")[1],document.getElementById("validate-button").addEventListener("click",a),t=Office.context.mailbox.item,document.getElementById("client-select").addEventListener("change",(function(){document.getElementById("validation-status").textContent="",document.getElementById("validation-results").innerHTML=""})),t.body.getAsync("html",(function(e){e.status===Office.AsyncResultStatus.Succeeded&&(e.value,t.addHandlerAsync(Office.EventType.ItemChanged,(function(){a()})))}))}}))}()}();